[Main](../README.md)
---

## **Lesson Plan: Git Version Control**

### **1. Git Fundamentals and Workflow**

**Useful Information:**
* **Git:** Distributed version control system that tracks changes in source code
* **Repository:** Storage location for your project with complete history
* **Three main areas:**
  - Working Directory: Your local files
  - Staging Area: Files ready to be committed
  - Repository: Committed changes stored permanently

**Initial Setup & Configuration:**

```bash
# Install Git (if not already installed)
sudo apt update && sudo apt install git

# Configure user identity (crucial for commits)
git config --global user.name "Student One"
git config --global user.email "student1@training.com"

# Configure helpful settings
git config --global color.ui auto
git config --global core.editor nano
git config --global init.defaultBranch main

# Check configuration
git config --list

# Practice Task 1:
# 1. Configure your global Git identity
# 2. Set your preferred text editor
# 3. Verify your configuration
```

**Creating and Cloning Repositories:**

```bash
# Initialize a new repository
mkdir my-project
cd my-project
git init

# Clone an existing repository
git clone https://github.com/user/repo.git
git clone /path/to/existing/repo new-local-copy

# Check repository status
git status

# Practice Task 2:
# 1. Create a new directory 'git-practice' and initialize a Git repository
# 2. Check the status of your new repository
# 3. Clone the instructor's practice repository (if available)
```

**Basic Git Workflow:**

```bash
# Create some files
echo "# My Project" > README.md
mkdir src
echo "console.log('Hello Git');" > src/app.js

# Add files to staging area
git add README.md
git add src/app.js
git add .                          # Add all files in current directory

# Commit changes with descriptive message
git commit -m "Initial commit: Add project structure and basic files"

# Check the commit history
git log
git log --oneline                 # Compact view
git log --graph --oneline --all   # Graphical view

# Practice Task 3:
# 1. Create a simple project with at least two files
# 2. Stage and commit your initial files
# 3. Modify one file and add a new file
# 4. Stage and commit these changes separately
# 5. View your commit history
```

**Understanding File States:**

```bash
# Check what files are modified/untracked
git status

# See changes in working directory
git diff                          # Unstaged changes
git diff --staged                 # Staged changes

# Remove files from staging area
git reset HEAD filename           # Unstage file

# Discard changes in working directory
git checkout -- filename          # Restore file to last committed state

# Practice Task 4:
# 1. Modify a tracked file and create a new untracked file
# 2. Use 'git status' to see the different states
# 3. Use 'git diff' to see your changes
# 4. Stage the changes, then unstage one file
# 5. Discard changes to one file using 'git checkout --'
```

**Best Practices:**
* Commit early and often
* Write clear, descriptive commit messages
* One logical change per commit
* Don't commit generated files or sensitive information
* Use `.gitignore` to exclude unnecessary files

---

### **2. Branching**

**Useful Information:**
* **Branch:** Independent line of development
* **Main/Master:** Default branch, typically represents production-ready code
* **Feature branches:** Isolate new features or bug fixes
* **HEAD:** Pointer to current branch/commit

**Branch Operations:**

```bash
# List branches
git branch                        # Local branches
git branch -r                     # Remote branches
git branch -a                     # All branches

# Create and switch to new branch
git branch new-feature            # Create branch
git checkout new-feature          # Switch to branch
git checkout -b new-feature       # Create and switch in one command

# Modern branch commands (Git 2.23+)
git switch new-feature            # Switch to existing branch
git switch -c new-feature         # Create and switch to new branch

# Delete branches
git branch -d feature-done        # Delete merged branch
git branch -D feature-abandoned   # Force delete unmerged branch

# Practice Task 5:
# 1. Create a new branch 'contact-form'
# 2. Switch to that branch and create a file 'contact.html'
# 3. Make several commits on the branch
# 4. Switch back to main and verify contact.html doesn't exist
# 5. List all your branches
```

**Branching Strategies:**

```bash
# Common branch naming conventions
git checkout -b feature/user-authentication
git checkout -b bugfix/login-error
git checkout -b hotfix/critical-security-patch
git checkout -b release/v1.2.0

# Compare branches
git log main..feature-branch      # Commits in feature not in main
git diff main feature-branch      # Differences between branches

# Practice Task 6:
# 1. Create feature branches for different parts of a website:
#    - 'feature/homepage'
#    - 'feature/about-page' 
#    - 'bugfix/footer-links'
# 2. Make changes in each branch
# 3. Compare each feature branch with main
```

**Stashing Changes:**

```bash
# Save uncommitted changes temporarily
git stash                         # Stash changes
git stash save "Work in progress" # Stash with message

# List stashes
git stash list

# Restore stashed changes
git stash pop                     # Apply and remove most recent stash
git stash apply                   # Apply but keep in stash list

# Clean up stashes
git stash drop                    # Remove most recent stash
git stash clear                   # Remove all stashes

# Practice Task 7:
# 1. Make changes to a file but don't commit
# 2. Stash your changes
# 3. Switch to a different branch and make a commit
# 4. Return to original branch and pop your stash
# 5. Verify your changes are restored
```

**Best Practices:**
* Use descriptive branch names
* Keep branches focused on single purposes
* Regularly sync feature branches with main
* Delete merged branches to keep repository clean
* Use stashing to context-switch efficiently

---

### **3. Merging and Collaboration**

**Useful Information:**
* **Merge:** Combine changes from different branches
* **Fast-forward merge:** When no divergent changes exist
* **Three-way merge:** Creates merge commit when branches have diverged
* **Merge conflicts:** Occur when Git can't automatically resolve differences

**Basic Merging:**

```bash
# Merge a branch into current branch
git checkout main
git merge feature-branch

# If fast-forward is possible but you want merge commit
git merge --no-ff feature-branch

# Practice Task 8:
# 1. On main branch, merge your 'contact-form' branch
# 2. Check the log to see the merge commit
# 3. Delete the feature branch after successful merge
```

**Handling Merge Conflicts:**

```bash
# Create a conflict scenario
# On branch main: modify line 1 of file.txt to "Main branch change"
# On branch feature: modify line 1 of file.txt to "Feature branch change"

# Try to merge
git checkout main
git merge feature-branch

# Resolve the conflict
cat file.txt
# Shows:
# <<<<<<< HEAD
# Main branch change  
# =======
# Feature branch change
# >>>>>>> feature-branch

# Edit file to resolve conflict, then:
git add file.txt
git commit -m "Resolve merge conflict in file.txt"

# Practice Task 9:
# 1. Create a file 'config.txt' in main branch
# 2. Create the same file in a feature branch with different content
# 3. Try to merge and resolve the conflict
# 4. Complete the merge with a proper commit message
```

**Remote Repositories and Collaboration:**

```bash
# Add remote repositories
git remote add origin /opt/git/shared-repo.git
git remote -v                     # List remotes

# Push branches to remote
git push -u origin main           # First push, set upstream
git push origin feature-branch    # Push specific branch

# Pull changes from remote
git pull origin main              # Fetch and merge
git fetch origin                  # Download changes without merging
git merge origin/main             # Merge fetched changes

# Practice Task 10:
# 1. Add the instructor's shared repository as a remote
# 2. Push your main branch to the shared repository
# 3. Pull changes made by other students
# 4. Create a feature branch and push it to the remote
```

**Collaboration Workflow:**

```bash
# Standard feature branch workflow
git checkout -b feature/new-widget
# ... make changes and commit ...
git push -u origin feature/new-widget

# Create Pull Request (on GitHub/GitLab) or inform team
# After review and approval:
git checkout main
git pull origin main              # Get latest changes
git merge feature/new-widget
git push origin main
git branch -d feature/new-widget
git push origin --delete feature/new-widget

# Practice Task 11:
# 1. Work in pairs: Student A creates a repository, Student B clones it
# 2. Both create feature branches and make changes
# 3. Push branches and practice merging each other's work
# 4. Handle any merge conflicts that arise
```

**Rebasing (Alternative to Merging):**

```bash
# Rebase feature branch onto main
git checkout feature-branch
git rebase main

# Interactive rebase (squash commits, reorder, edit)
git rebase -i HEAD~3              # Rebase last 3 commits

# Practice Task 12:
# 1. Create a branch with multiple small commits
# 2. Use interactive rebase to squash them into one logical commit
# 3. Rebase your feature branch onto the latest main
```

**Tagging and Releases:**

```bash
# Create tags
git tag v1.0.0                    # Lightweight tag
git tag -a v1.0.0 -m "Version 1.0.0 release"  # Annotated tag

# List tags
git tag

# Push tags to remote
git push origin v1.0.0
git push origin --tags            # Push all tags

# Practice Task 13:
# 1. Create an annotated tag for your current project state
# 2. Push the tag to the remote repository
# 3. Checkout code at that tag to verify
```

**Best Practices for Collaboration:**
* Always pull before pushing
* Use descriptive commit messages
* Keep commits focused and atomic
* Review code before merging
* Use feature branches for all changes
* Communicate with your team about what you're working on

---

## **Homework Assignment: Git Collaboration Project**

**Instructions:** Complete this group project using the shared Git repository. Each student will work on different features.

**Setup - Instructor creates shared repository:**
```bash
# On server, as instructor:
sudo mkdir -p /opt/git/project.git
cd /opt/git/project.git
sudo git init --bare
sudo chown -R student1:students /opt/git/project.git
sudo chmod -R 775 /opt/git/project.git
```

**Tasks:**

1. **Individual Git Setup (20 points)**
   Each student creates `git-setup.md` documenting:
   - Their Git configuration
   - SSH key setup for the shared repository
   - Initial clone of the shared project
   - Their first commit with a personal profile page

2. **Feature Branch Development (30 points)**
   Each student takes one feature:
   - Student 1: Homepage (`feature/homepage`)
   - Student 2: About Page (`feature/about-page`) 
   - Student 3: Contact Form (`feature/contact-form`)
   - Student 4: Navigation Menu (`feature/navigation`)
   - Student 5: Footer (`feature/footer`)

   Requirements:
   - Create feature branch from main
   - Make at least 3 commits per feature
   - Push branch to shared repository
   - Create merge requests (or inform group for review)

3. **Merge Coordination (25 points)**
   As a group:
   - Review each other's code
   - Handle merge conflicts systematically
   - Maintain a clean commit history
   - Create tagged releases at v1.0.0 and v1.1.0
   - Document the merge process in `MERGE_LOG.md`

4. **Collaboration Challenge (25 points)**
   Simulate real-world scenarios:
   - Hotfix: Fix a critical bug in production while features are in development
   - Feature conflict: Two students modify the same file, resolve conflicts
   - Rollback: Revert a bad commit and continue development
   - Documentation: Create `COLLABORATION_GUIDE.md` for your team

**Example Project Structure:**
```
website-project/
├── index.html          # Homepage
├── about.html          # About page  
├── contact.html        # Contact form
├── css/
│   └── style.css       # Shared styles
├── js/
│   └── main.js         # Shared JavaScript
└── README.md           # Project documentation
```

**Example conflict resolution script:**
```bash
#!/bin/bash
# resolve-conflicts.sh

echo "=== Git Conflict Resolution Helper ==="

# Check if we're in a merge state
if [ -f ".git/MERGE_HEAD" ]; then
    echo "Merge in progress. Conflicts:"
    git diff --name-only --diff-filter=U
    
    echo "Would you like to:"
    echo "1) Accept incoming changes (theirs)"
    echo "2) Keep current changes (ours)" 
    echo "3) Open files to manually resolve"
    read -p "Choose option: " choice
    
    case $choice in
        1) git checkout --theirs . && git add . ;;
        2) git checkout --ours . && git add . ;;
        3) echo "Open files listed above to resolve conflicts" ;;
    esac
else
    echo "No merge conflict detected"
fi
```

**Submission Requirements:**
- Individual: `git-setup.md` in your home directory
- Group: Complete website project in shared repository
- Documentation: `COLLABORATION_GUIDE.md` and `MERGE_LOG.md`
- Each student must have at least 10 meaningful commits
- Repository must have proper branching structure and tags

**Bonus Challenge:**
Set up Git hooks for:
- Pre-commit: Check for debugging code
- Pre-push: Run basic HTML validation
- Post-merge: Update dependencies automatically

This homework will give students practical experience with Git workflows, branching strategies, and team collaboration - essential skills for any development or operations role!

[Main](../README.md)
---